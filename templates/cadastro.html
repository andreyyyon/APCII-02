{% extends "base.html" %}

{% block content %}
<section class="form-section">    
    <h2>Cadastrar Veículo</h2>

    {% if mensagem %}
      <div class="mensagem-info">{{ mensagem }}</div>
    {% endif %}

    <form method="POST" class="form-card">
        <label for="type">Tipo do Veículo</label>
        <select name="type" id="type" required>
            <option value="C" {% if tipo == "C" %}selected{% endif %}>Carro</option>
            <option value="M" {% if tipo == "M" %}selected{% endif %}>Moto</option>
        </select>

        <label for="placa">Placa</label>
        <input type="text" id="placa" name="placa" value="{{ placa or '' }}" required>

        <label for="modelo">Modelo</label>
        <input type="text" id="modelo" name="modelo" value="{{ modelo or '' }}" required>

        <label for="cor">Cor</label>
        <input type="text" id="cor" name="cor" value="{{ cor or '' }}" required>
        
        <div id="esp_carro" class="fade {% if tipo != 'C' %}hide{% endif %}">
            <label for="tamanho">Tamanho</label>
            <select name="tamanho" id="tamanho" {% if tipo == 'C' %}required{% endif %}>
                <option value="M" {% if tamanho == "M" %}selected{% endif %}>Médio</option>
                <option value="G" {% if tamanho == "G" %}selected{% endif %}>Grande</option>
            </select>
        </div>

        <div id="esp_moto" class="fade {% if tipo != 'M' %}hide{% endif %}">
            <label for="tipoMoto">Tipo de motorização</label>
            <select name="tipoMoto" id="tipoMoto" required>
                <option value="combustao" {% if tipoMoto == "combustao" %}selected{% endif %}>Combustão</option>
                <option value="eletrica" {% if tipoMoto == "eletrica" %}selected{% endif %}>Elétrica</option>
            </select>
        </div>

        <button type="submit">Salvar</button>
    </form>
</section>

<script>
    const type = document.getElementById("type");
    const esp_carro = document.getElementById("esp_carro");
    const esp_moto = document.getElementById("esp_moto");

    function toggleExtraFields() {
        if(type.value === "M"){
            esp_carro.classList.add("hide");
            esp_moto.classList.remove("hide");
        } else {
            esp_moto.classList.add("hide");
            esp_carro.classList.remove("hide");
        }
    }

    type.addEventListener("change", toggleExtraFields);

    // chama ao carregar para manter estado correto quando template renderizar com valores
    toggleExtraFields();
</script>
{% endblock %}


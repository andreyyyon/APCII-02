{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    {% if mensagem %}
        <div class="alert alert-{{ alert }} alert-dismissible fade show position-absolute bottom-0 end-0 m-3" role="alert">
            {{ mensagem }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endif %}

    <div class="row justify-content-center">
        <div class="col-lg-10 col-md-10">
            <div class="card shadow-sm p-4">
                <h2 class="text-center mb-3">Cadastrar Veículo</h2>
    
                <form method="POST" class="">
                    <div class="mb-3">
                        <label for="type" class="form-label">Tipo do Veículo</label>
                        <select name="type" id="type" required class="form-select">
                            <option value="C" {% if tipo == "C" %}selected{% endif %}>Carro</option>
                            <option value="M" {% if tipo == "M" %}selected{% endif %}>Moto</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="placa">Placa</label>
                        <input class="form-control" type="text" id="placa" name="placa" value="{{ placa or '' }}" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="modelo">Modelo</label>
                        <input class="form-control" type="text" id="modelo" name="modelo" value="{{ modelo or '' }}" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label" for="cor">Cor</label>
                        <input class="form-control" type="text" id="cor" name="cor" value="{{ cor or '' }}" required>
                    </div>
                    
                    
                    <div id="esp_carro" class="fade show mb-3">
                        <label class="form-label" for="tamanho">Tamanho</label>
                        <select class="form-select" name="tamanho" id="tamanho">
                            <option value="M">Médio</option>
                            <option value="G">Grande</option>
                        </select>
                    </div>
    
                    <div id="esp_moto" class="fade show mb-3 hide">
                        <label class="form-label" for="tipoMoto">Tipo de motorização</label>
                        <select class="form-select" name="tipoMoto" id="tipoMoto" required>
                            <option value="combustao">Combustão</option>
                            <option value="eletrica">Elétrica</option>
                        </select>
                    </div>
    
                    <button type="submit" class="btn btn-dark">Salvar</button>
                </form>
            </div>
        </div>
    </div>    
</div>

<script>
    const type = document.getElementById("type");
    const esp_carro = document.getElementById("esp_carro");
    const esp_moto = document.getElementById("esp_moto");

    function toggleExtraFields() {
        if(type.value === "M"){
            esp_carro.classList.add("hide");
            esp_carro.removeAttribute("required")
            esp_moto.classList.remove("hide");
            esp_moto.setAttribute("required")   
            esp_carro.value("");
        } else {
            esp_moto.classList.add("hide");
            esp_moto.removeAttribute("required")
            esp_carro.classList.remove("hide");
            esp_carro.setAttribute("required")
            esp_moto.value("")
        }
    }

    type.addEventListener("change", toggleExtraFields);

    // chama ao carregar para manter estado correto quando template renderizar com valores
    toggleExtraFields();
</script>
{% endblock %}

